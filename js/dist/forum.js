(()=>{var e={n:r=>{var t=r&&r.__esModule?()=>r.default:()=>r;return e.d(t,{a:t}),t},d:(r,t)=>{for(var o in t)e.o(t,o)&&!e.o(r,o)&&Object.defineProperty(r,o,{enumerable:!0,get:t[o]})},o:(e,r)=>Object.prototype.hasOwnProperty.call(e,r),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};(()=>{"use strict";e.r(r);const t=flarum.core.compat["forum/app"];var o=e.n(t);const n=flarum.core.compat["common/extend"],i=flarum.core.compat["common/components/Tooltip"];var a=e.n(i);const u=flarum.core.compat["forum/components/Composer"];var s=e.n(u);const c=flarum.core.compat["forum/components/ComposerBody"];var f=e.n(c);const p=flarum.core.compat["forum/components/ComposerButton"];var l=e.n(p),y={};function d(){var e;return null==(e=o().session.user)?void 0:e.preferences().muteTypewriter}function v(e){-1===Object.keys(y).indexOf(e)&&(y[e]=new Audio(e))}function w(){if(!d()){var e=o().forum.attribute("typewriterDefaultFile");e&&v(e);var r=o().forum.attribute("typewriterSounds");Array.isArray(r)&&r.forEach((function(e){e.file&&v(e.file),e.keys&&(e.regex=new RegExp(e.keys))}))}}function b(e){d()||(o().forum.attribute("debug")&&console.info("[typewriter] Playing "+e),-1!==Object.keys(y).indexOf(e)?y[e].cloneNode(!1).play():console.error("[typewriter] File "+e+" not loaded"))}function g(e){!function(e){var r=o().forum.attribute("typewriterSounds");if(Array.isArray(r))for(var t=0;t<r.length;t++){var n=r[t];if(n.regex&&n.file&&n.regex.test(e))return void b(n.file)}var i=o().forum.attribute("typewriterDefaultFile");i&&b(i)}(e.key)}o().initializers.add("typewriter",(function(){(0,n.extend)(s().prototype,"controlItems",(function(e){var r=this;if(o().session.user){var t=o().session.user.preferences().muteTypewriter;e.add("typewriter",a().component({text:o().translator.trans("clarkwinkelmann-typewriter.forum.mute")},l().component({icon:"typewriter-mute fas fa-"+(t?"volume-mute":"volume-up"),onclick:function(){r.muteTypewriterLoading=!0,o().session.user.savePreferences({muteTypewriter:!t}).then((function(){r.muteTypewriterLoading=!1,m.redraw(),w()}))},loading:this.muteTypewriterLoading})),10)}})),(0,n.extend)(f().prototype,"oncreate",(function(){w(),this.element.addEventListener("keydown",g)})),(0,n.extend)(f().prototype,"onremove",(function(){this.element.removeEventListener("keydown",g)}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map